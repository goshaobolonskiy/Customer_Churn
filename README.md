# Customer Churn Prediction ‚Äî Production-Ready ML Pipeline

[![Python](https://img.shields.io/badge/Python-3.9+-blue?logo=python)](https://python.org)
[![scikit-learn](https://img.shields.io/badge/scikit--learn-1.0+-orange?logo=scikit-learn)](https://scikit-learn.org)
[![CatBoost](https://img.shields.io/badge/CatBoost-1.2+-yellow?logo=catboost)](https://catboost.ai)
–ü–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç—Ç–æ–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ (customer churn). –ü—Ä–æ–µ–∫—Ç –æ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –¥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π
–∏ –±–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏–∑–∞.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–û –ø—Ä–æ–µ–∫—Ç–µ](#-–æ-–ø—Ä–æ–µ–∫—Ç–µ)
- [–ë–∏–∑–Ω–µ—Å-–∏–Ω—Å–∞–π—Ç—ã](#-–±–∏–∑–Ω–µ—Å-–∏–Ω—Å–∞–π—Ç—ã)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
- [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
- [–†–µ–∑—É–ª—å—Ç–∞—Ç—ã](#—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)
- [–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏](#-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏)

## üéØ –û –ø—Ä–æ–µ–∫—Ç–µ

**–ó–∞–¥–∞—á–∞:** –ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å, —É–π–¥–µ—Ç –∫–ª–∏–µ–Ω—Ç —Ç–µ–ª–µ–∫–æ–º-–∫–æ–º–ø–∞–Ω–∏–∏ –∏–ª–∏ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è, –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –∏—Å—Ç–æ—Ä–∏–∏
–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —É—Å–ª—É–≥.
**–¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å –ø–∞–π–ø–ª–∞–π–Ω, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏–π –≤—Å–µ —ç—Ç–∞–ø—ã —Ä–∞–±–æ—Ç—ã Data Scientist'–∞:

- EDA
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤
- –†–∞–±–æ—Ç–∞ —Å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
- Feature engineering
- –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- –û—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- –ë–æ—Ä—å–±–∞ —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º –∫–ª–∞—Å—Å–æ–≤
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
- –ë–∏–∑–Ω–µ—Å-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## üí° –ë–∏–∑–Ω–µ—Å-–∏–Ω—Å–∞–π—Ç—ã

–í —Ö–æ–¥–µ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –±—ã–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏:

### 1. –ö–ª–∏–µ–Ω—Ç—ã —Å –≤—ã—Å–æ–∫–∏–º–∏ –ø–ª–∞—Ç–µ–∂–∞–º–∏ ‚Äî –Ω–µ –≤—ã–±—Ä–æ—Å—ã, –∞ —Ü–µ–Ω–Ω—ã–µ –∞–∫—Ç–∏–≤—ã

–£–¥–∞–ª–µ–Ω–∏–µ "–≤—ã–±—Ä–æ—Å–æ–≤" —Å –≤—ã—Å–æ–∫–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ `TotalCharges` –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ **—É—Ö—É–¥—à–µ–Ω–∏—é –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏** (F1 –ø–∞–¥–∞–ª —Å 0.6327
–¥–æ ~0.6200). –≠—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –±–∏–∑–Ω–µ—Å-–≥–∏–ø–æ—Ç–µ–∑—É: –∫–ª–∏–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–Ω–æ–≥–æ –ø–ª–∞—Ç—è—Ç ‚Äî –Ω–µ –∞–Ω–æ–º–∞–ª–∏–∏, –∞ **–ª–æ—è–ª—å–Ω—ã–µ –∏ —Ü–µ–Ω–Ω—ã–µ
–∫–ª–∏–µ–Ω—Ç—ã**, –∫–æ—Ç–æ—Ä—ã—Ö –Ω—É–∂–Ω–æ —É–¥–µ—Ä–∂–∏–≤–∞—Ç—å.

### 2. CatBoost –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Å–ª–æ–∂–Ω–æ–π –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏

–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –Ω–∞ —Å—ã—Ä—ã—Ö –∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ–∫–∞–∑–∞–ª–æ, —á—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –±—É—Å—Ç–∏–Ω–≥–∏ –æ—Ç–ª–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç "–∏–∑ –∫–æ—Ä–æ–±–∫–∏".
–†–∞–∑–Ω–∏—Ü–∞ –≤ –º–µ—Ç—Ä–∏–∫–∞—Ö –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏ (¬±0.01-0.02 –ø–æ F1).

### 3. –î–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤ –Ω–µ –∫—Ä–∏—Ç–∏—á–µ–Ω –¥–ª—è –±—É—Å—Ç–∏–Ω–≥–æ–≤

–î–∞–∂–µ –±–µ–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –±–æ—Ä—å–±—ã —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º, –º–æ–¥–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ –≤—ã—Å–æ–∫–∏–π Recall (>0.79), —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
CatBoost —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –¥–∞–Ω–Ω—ã—Ö.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

customer_churn/  
‚îú‚îÄ‚îÄ main.py # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º  
‚îú‚îÄ‚îÄ main_silent.py # –¢–∏—Ö–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è production  
‚îú‚îÄ‚îÄ README.md # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞  
‚îú‚îÄ‚îÄ requirements.txt # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏  
‚îÇ  
‚îú‚îÄ‚îÄ eda.py # –†–∞–∑–≤–µ–¥—ã–≤–∞—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑  
‚îú‚îÄ‚îÄ outliers.py # –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤  
‚îú‚îÄ‚îÄ missing_values.py # –†–∞–±–æ—Ç–∞ —Å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏  
‚îú‚îÄ‚îÄ split.py # –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö  
‚îú‚îÄ‚îÄ encoding_features.py # –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤  
‚îú‚îÄ‚îÄ Feature_Engineering.py # –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤  
‚îú‚îÄ‚îÄ feature_selection.py # –û—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤  
‚îú‚îÄ‚îÄ imbalanced_classes.py # –ë–æ—Ä—å–±–∞ —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º –∫–ª–∞—Å—Å–æ–≤  
‚îî‚îÄ‚îÄ models.py # –ú–æ–¥–µ–ª–∏ –∏ –∏—Ö —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**

```bash
git clone https://github.com/goshaobolonskiy/Customer_Churn
cd customer-churn-prediction
```

2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**

```
pip install -r requirements.txt
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –î–≤–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã

**main.py**‚Äî –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∏ –æ—Ç–ª–∞–¥–∫–∏:

```
python main.py
```

- –ü–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥ –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –¥–æ/–ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏

**main_silent.py**‚Äî –¥–ª—è production:

```
python main_silent.py
```

- –ú–∏–Ω–∏–º—É–º –≤—ã–≤–æ–¥–∞ –≤ –∫–æ–Ω—Å–æ–ª—å
- –¢–æ–ª—å–∫–æ —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
- –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ CatBoost

| –ú–µ—Ç—Ä–∏–∫–∞   | –°—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ | –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ  | –ò–∑–º–µ–Ω–µ–Ω–∏–µ     |
|-----------|--------------|---------------|---------------|
| Accuracy  | 0.7544       | 0.7317-0.7502 | ‚ñº 0.004-0.022 |
| Precision | 0.5246       | 0.4967-0.5190 | ‚ñº 0.006-0.028 |
| Recall    | 0.7968       | 0.7941-0.8128 | ‚ñ≤ 0.000-0.016 |
| F1-score  | 0.6327       | 0.6166-0.6303 | ‚ñº 0.002-0.016 |
| ROC-AUC   | 0.8457       | 0.8359-0.8458 | ‚ñº 0.000-0.010 |

### –ö–ª—é—á–µ–≤—ã–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è:

1. **–õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –Ω–∞ —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö**(F1 = 0.6327)

2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–∞–µ—Ç –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è**(–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏)

3. **–£–¥–∞–ª–µ–Ω–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤ —Å—Ç–∞–±–∏–ª—å–Ω–æ —É—Ö—É–¥—à–∞–µ—Ç Recall**‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –±–∏–∑–Ω–µ—Å-–≥–∏–ø–æ—Ç–µ–∑—É –æ —Ü–µ–Ω–Ω–æ—Å—Ç–∏ "–¥–æ—Ä–æ–≥–∏—Ö" –∫–ª–∏–µ–Ω—Ç–æ–≤

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Python 3.9+**‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫
- **pandas / numpy**‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- **scikit-learn**‚Äî –ø–∞–π–ø–ª–∞–π–Ω—ã, –º–µ—Ç—Ä–∏–∫–∏, –æ—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- **CatBoost**‚Äî –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –±—É—Å—Ç–∏–Ω–≥ (–æ—Å–Ω–æ–≤–Ω–∞—è –º–æ–¥–µ–ª—å)
- **XGBoost / LightGBM / RandomForest**‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- **imbalanced-learn**‚Äî –±–æ—Ä—å–±–∞ —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º –∫–ª–∞—Å—Å–æ–≤